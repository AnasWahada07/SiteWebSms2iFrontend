<div class="container">

  <div class="row mb-4 align-items-center">
    <div class="col-md-6 mb-2 mb-md-0">
      <input
        type="text"
        class="form-control shadow-sm"
        placeholder="üîç Rechercher par titre ou client"
        [(ngModel)]="searchQuery"
        (ngModelChange)="applyFilter()" />
    </div>

    <div class="col-md-6 text-md-end d-flex flex-wrap gap-2 justify-content-md-end">
      <!-- Bouton Retour Dashboard -->
      <button class="btn btn-outline-primary btn-sm shadow-sm" (click)="goToDashboard()">
        <i class="bi bi-arrow-left me-1"></i> Retour au Dashboard
      </button>

      <!-- Bouton R√©initialiser -->
      <button class="btn btn-outline-secondary btn-sm shadow-sm" (click)="resetFilter()">
        <i class="bi bi-x-circle me-1"></i> R√©initialiser Recherche
      </button>
    </div>
  </div>

  <div class="galerie-list">
    <h2 class="section-title">Mes Galeries</h2>

    <!-- Affichage conditionnel -->
    <div *ngIf="galeries.length > 0; else noGalerie">
      <div class="galerie-grid">
        <div class="galerie-card" *ngFor="let galerie of galeries">
          <div class="card-image-container">
            <img [src]="galerie.imageUrl || 'assets/default-image.jpg'" alt="{{galerie.title}}" />
            <div class="card-actions">
              <button class="action-btn edit-btn" (click)="onEdit(galerie)" title="Modifier">
                <i class="fas fa-edit"></i>
              </button>
              <button class="action-btn delete-btn" (click)="onDelete(galerie.id!)" title="Supprimer">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </div>
          <div class="card-content">
            <h3>{{ galerie.title }}</h3>
            <p class="description">{{ galerie.description }}</p>
            <div class="client-info">
              <i class="fas fa-user"></i>
              <span>{{ galerie.client || 'Non sp√©cifi√©' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Message si aucune galerie -->
    <ng-template #noGalerie>
      <div class="no-galerie-message">
        <i class="fas fa-folder-open"></i>
        <p>Aucun projet trouv√©.</p>
      </div>
    </ng-template>
  </div>

  <!-- ‚ûï Formulaire d'ajout -->
  <div class="galerie-form">
    <div class="form-header">
      <h2>Ajouter une galerie</h2>
    </div>

    <form [formGroup]="galerieForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label>Titre</label>
        <input formControlName="title" placeholder="Donnez un titre √† votre galerie" />
      </div>

      <div class="form-group">
        <label>Description</label>
        <textarea formControlName="description" placeholder="D√©crivez cette galerie"></textarea>
      </div>

      <div class="form-group">
        <label>Client</label>
        <input formControlName="client" placeholder="Pour quel client ?" />
      </div>

      <div class="form-group file-upload">
        <label>Image</label>
        <div class="upload-area" (click)="fileInput.click()">
          <i class="fas fa-cloud-upload-alt"></i>
          <p>S√©lectionnez une image</p>
          <input #fileInput type="file" (change)="onFileSelected($event)" accept="image/*" hidden />
        </div>

        <!-- Aper√ßu de l'image s√©lectionn√©e -->
        <div class="image-preview-container" *ngIf="selectedImageUrl">
          <p>Aper√ßu de l'image :</p>
          <img [src]="selectedImageUrl" alt="Aper√ßu image" class="image-preview" />
        </div>
      </div>

      <div class="button-group">
        <button type="submit" class="primary-btn" [disabled]="galerieForm.invalid">
          Ajouter
        </button>
      </div>
    </form>
  </div>
</div>

<footer class="text-center py-3 bg-light border-top mt-4">
  <div class="small text-muted">
    &copy; {{ currentYear || '2025' }} <strong class="text-dark">SMS2I</strong> ‚Äî Tous droits r√©serv√©s.
  </div>
  <div class="small">
    Con√ßu <i class="bi bi-heart-fill text-danger mx-1"></i> par l‚Äô√©quipe <span class="text-primary fw-semibold">SMS2I</span>
  </div>
</footer>
