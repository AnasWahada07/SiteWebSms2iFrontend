

<div class="projects-container">
  <div class="row mb-4">
  <div class="col-md-8">
    <input
      type="text"
      class="form-control shadow-sm"
      placeholder="üîç Rechercher par titre ou client"
      [(ngModel)]="searchQuery"
      (ngModelChange)="applyProjetFilter()" />
  </div>
  <div class="col-md-4 text-end">
    <button class="btn btn-outline-secondary btn-sm shadow-sm" (click)="resetProjetFilter()">
      <i class="bi bi-x-circle me-1"></i> R√©initialiser Recherche
    </button>
  </div>
</div>

  <!-- Liste des projets -->
<div class="projects-header">
  <h2 class="section-title">Liste des Projets</h2>
  <div class="projects-count">{{ projets.length }} projet(s)</div>
</div>

  <ul class="projects-list">
    <li *ngFor="let projet of projets; let i = index" class="project-card" [style.--delay]="i * 0.05 + 's'">
      <div class="project-header">
        <h3 class="project-title">{{ projet.title }}</h3>
        <span class="project-duration">{{ projet.duree }}</span>
      </div>

      <div class="project-image-container">
        <img *ngIf="projet.imageUrl" [src]="projet.imageUrl" class="project-image" alt="Image du projet {{projet.title}}">
        <div *ngIf="!projet.imageUrl" class="image-placeholder">
          <svg width="24" height="24" viewBox="0 0 24 24">
            <path fill="currentColor"
              d="M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M13.96,12.29L11.21,15.83L9.25,13.47L6.5,17H17.5L13.96,12.29Z" />
          </svg>
        </div>
      </div>

      <div class="project-meta">
        <span *ngIf="projet.client" class="meta-item">
          <svg width="18" height="18" viewBox="0 0 24 24">
            <path fill="currentColor"
              d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" />
          </svg>
          {{ projet.client }}
        </span>
        <span *ngIf="projet.technologie" class="meta-item">
          <svg width="18" height="18" viewBox="0 0 24 24">
            <path fill="currentColor"
              d="M5,3H19A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3M7,7V9H9V7H7M11,7V9H13V7H11M15,7V9H17V7H15M7,11V13H9V11H7M11,11V13H13V11H11M15,11V13H17V11H15M7,15V17H9V15H7M11,15V17H13V15H11M15,15V17H17V15H15Z" />
          </svg>
          {{ projet.technologie }}
        </span>
      </div>

      <p class="project-description" *ngIf="projet.description">{{ projet.description }}</p>

      <div class="project-actions">
        <button (click)="editProjet(projet)" class="btn-edit">
          <svg width="18" height="18" viewBox="0 0 24 24">
            <path fill="currentColor"
              d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
          </svg>
          Modifier
        </button>
        <button (click)="deleteProjet(projet.id!)" class="btn-delete">
          <svg width="18" height="18" viewBox="0 0 24 24">
            <path fill="currentColor"
              d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" />
          </svg>
          Supprimer
        </button>
      </div>
    </li>
  </ul>

  <!-- Formulaire d'ajout -->
  <div class="form-section">
    <h3 class="section-title">Ajouter un projet</h3>

    <form (ngSubmit)="saveProjet()" class="project-form">
      <div class="form-group floating-label">
        <input [(ngModel)]="newProjet.title" name="title" id="title" placeholder=" " required />
        <label for="title">Titre*</label>
      </div>

      <div class="form-group floating-label">
        <textarea [(ngModel)]="newProjet.description" name="description" id="description" placeholder=" " required></textarea>
        <label for="description">Description*</label>
      </div>

      <div class="form-row">
        <div class="form-group floating-label">
          <input [(ngModel)]="newProjet.duree" name="duree" id="duree" placeholder=" " />
          <label for="duree">Dur√©e</label>
        </div>
        <div class="form-group floating-label">
          <input [(ngModel)]="newProjet.client" name="client" id="client" placeholder=" " />
          <label for="client">Client</label>
        </div>
      </div>

      <div class="form-group floating-label">
        <input [(ngModel)]="newProjet.technologie" name="technologie" id="technologie" placeholder=" " />
        <label for="technologie">Technologie</label>
      </div>

      <div class="file-upload">
        <label class="upload-button">
          <input type="file" (change)="onFileSelected($event)" accept="image/*" />
          <span class="upload-label">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path fill="currentColor" d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
            </svg>
            Choisir une image
          </span>
        </label>

        <div *ngIf="previewUrl" class="image-preview">
          <img [src]="previewUrl" alt="Aper√ßu image" />
          <button type="button" (click)="previewUrl = null" class="remove-image" aria-label="Supprimer l'image">
            <svg width="20" height="20" viewBox="0 0 24 24">
              <path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />
            </svg>
          </button>
        </div>
      </div>

      <button type="submit" class="btn-submit">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path fill="currentColor" d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
            </svg>
        Ajouter le projet
      </button>
    </form>
  </div>

  <!-- Modal de modification -->
  <div *ngIf="selectedProjet" class="edit-modal">
    <div class="modal-overlay" (click)="selectedProjet = null"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3>Modifier le projet</h3>
        <button (click)="selectedProjet = null" class="close-modal" aria-label="Fermer">
          <svg width="24" height="24" viewBox="0 0 24 24">
            <path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />
          </svg>
        </button>
      </div>

      <form (ngSubmit)="updateProjet()" class="project-form">
        <div class="form-group floating-label">
          <input [(ngModel)]="selectedProjet.title" name="editTitle" id="editTitle" placeholder=" ">
          <label for="editTitle">Titre</label>
        </div>

        <div class="form-group floating-label">
          <textarea [(ngModel)]="selectedProjet.description" name="editDescription" id="editDescription" placeholder=" "></textarea>
          <label for="editDescription">Description</label>
        </div>

        <div class="form-row">
          <div class="form-group floating-label">
            <input [(ngModel)]="selectedProjet.duree" name="editDuree" id="editDuree" placeholder=" ">
            <label for="editDuree">Dur√©e</label>
          </div>
          <div class="form-group floating-label">
            <input [(ngModel)]="selectedProjet.client" name="editClient" id="editClient" placeholder=" ">
            <label for="editClient">Client</label>
          </div>
        </div>

        <div class="form-group floating-label">
          <input [(ngModel)]="selectedProjet.technologie" name="editTechnologie" id="editTechnologie" placeholder=" ">
          <label for="editTechnologie">Technologie</label>
        </div>

        <div class="file-upload">
          <label class="upload-button">
            <input type="file" (change)="onEditFileSelected($event)" accept="image/*">
            <span class="upload-label">
              <svg width="24" height="24" viewBox="0 0 24 24">
                <path fill="currentColor" d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />
              </svg>
              Changer l'image
            </span>
          </label>

          <div *ngIf="editPreviewUrl || selectedProjet?.imageUrl" class="image-preview">
            <img [src]="editPreviewUrl || selectedProjet.imageUrl" alt="Image du projet" />
            <button type="button" (click)="editPreviewUrl = null; selectedProjet.imageUrl = null" class="remove-image" aria-label="Supprimer l'image">
              <svg width="20" height="20" viewBox="0 0 24 24">
                <path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />
              </svg>
            </button>
          </div>
        </div>

        <button type="submit" class="btn-submit">
          <svg width="20" height="20" viewBox="0 0 24 24">
            <path fill="currentColor" d="M17,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3M12,19C10.34,19 9,17.66 9,16C9,14.34 10.34,13 12,13C13.66,13 15,14.34 15,16C15,17.66 13.66,19 12,19M15,9H5V5H15V9Z" />
          </svg>
          Mettre √† jour
        </button>
      </form>
    </div>
  </div>
</div>

<footer class="text-center py-3 bg-light border-top mt-4">
  <div class="small text-muted">
    &copy; {{ currentYear || '2025' }} <strong class="text-dark">SMS2I</strong> ‚Äî Tous droits r√©serv√©s.
  </div>
  <div class="small">
    Con√ßu <i class="bi bi-heart-fill text-danger mx-1"></i> par l‚Äô√©quipe <span class="text-primary fw-semibold">SMS2I</span>
  </div>
</footer>

